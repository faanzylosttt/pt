<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Fixed Media Upload Hub</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    :root {
      --bg: #f8fafc;
      --card: #ffffff;
      --text: #1e293b;
      --border: #e2e8f0;
      --primary: #3b82f6;
    }
    body.dark {
      --bg: #0f172a;
      --card: #1e293b;
      --text: #f1f5f9;
      --border: #334155;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      transition: 0.3s;
    }
    .header {
      background: var(--card);
      padding: 1rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    .upload-box {
      background: var(--card);
      border: 2px dashed var(--border);
      border-radius: 12px;
      padding: 3rem;
      text-align: center;
      cursor: pointer;
      transition: 0.3s;
    }
    .upload-box:hover {
      border-color: var(--primary);
    }
    .upload-box.dragover {
      background: rgba(59, 130, 246, 0.05);
    }
    .host-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }
    .host-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      cursor: pointer;
      transition: 0.3s;
      text-align: center;
    }
    .host-card:hover, .host-card.selected {
      border-color: var(--primary);
      background: rgba(59, 130, 246, 0.1);
    }
    .host-icon {
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }
    .btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 1rem;
    }
    .result {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 1.5rem;
      margin-top: 1rem;
    }
    .hidden { display: none; }
    .preview-img {
      max-width: 200px;
      max-height: 200px;
      border-radius: 8px;
      margin-top: 1rem;
    }
  </style>
</head>
<body>
  <header class="header">
    <h1><i class="fas fa-cloud-upload-alt"></i> Fixed Media Upload Hub</h1>
    <button id="themeBtn" class="btn"><i class="fas fa-moon"></i></button>
  </header>

  <div class="container">
    <div class="upload-box" id="uploadBox">
      <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: var(--primary);"></i>
      <p>Drag & drop atau klik untuk upload file</p>
      <input type="file" id="fileInput" style="display: none;">
    </div>

    <div class="host-grid" id="hostGrid">
      <!-- Host akan diisi otomatis -->
    </div>

    <div id="resultBox" class="result hidden">
      <h3><i class="fas fa-check-circle"></i> Upload Berhasil!</h3>
      <p>URL: <a id="resultUrl" href="" target="_blank"></a> 
      <button class="btn" onclick="copyToClipboard()"><i class="fas fa-copy"></i> Copy</button></p>
      <div id="resultPreview"></div>
    </div>
  </div>

<script>
const hosts = [
  { name: 'Catbox', id: 'catbox', icon: 'fas fa-box', custom: false, url: 'https://catbox.moe/user/api.php' },
  { name: 'Pixeldrain', id: 'pixeldrain', icon: 'fas fa-tint', custom: true, url: 'https://pixeldrain.com/api/file' },
  { name: 'Transfer.sh', id: 'transfer', icon: 'fas fa-exchange-alt', custom: true, url: 'https://transfer.sh/' },
  { name: '0x0.st', id: '0x0', icon: 'fas fa-infinity', custom: false, url: 'https://0x0.st' },
  { name: 'File.io', id: 'fileio', icon: 'fas fa-file-export', custom: false, url: 'https://file.io/' },
  { name: 'GoFile', id: 'gofile', icon: 'fas fa-globe', custom: false, url: 'gofile' },
  { name: 'Oshi.at', id: 'oshi', icon: 'fas fa-share-alt', custom: true, url: 'https://oshi.at' },
  { name: 'TmpFiles', id: 'tmpfiles', icon: 'fas fa-clock', custom: false, url: 'https://tmpfiles.org/api/v1/upload' }
];

let selectedHost = 'catbox';
let uploadedFile = null;

// Theme toggle
document.getElementById('themeBtn').addEventListener('click', () => {
  document.body.classList.toggle('dark');
});

// Render hosts
function renderHosts() {
  const grid = document.getElementById('hostGrid');
  grid.innerHTML = hosts.map(host => `
    <div class="host-card ${host.id === selectedHost ? 'selected' : ''}" data-host="${host.id}">
      <div class="host-icon"><i class="${host.icon}"></i></div>
      <h4>${host.name}</h4>
      <small>${host.custom ? 'Custom name' : 'Auto name'}</small>
    </div>
  `).join('');

  document.querySelectorAll('.host-card').forEach(card => {
    card.addEventListener('click', () => {
      selectedHost = card.dataset.host;
      document.querySelectorAll('.host-card').forEach(c => c.classList.remove('selected'));
      card.classList.add('selected');
    });
  });
}

// File handling
const uploadBox = document.getElementById('uploadBox');
const fileInput = document.getElementById('fileInput');

uploadBox.addEventListener('click', () => fileInput.click());
fileInput.addEventListener('change', (e) => handleFile(e.target.files[0]));

// Drag & drop
['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
  uploadBox.addEventListener(eventName, (e) => {
    e.preventDefault();
    e.stopPropagation();
  });
});

uploadBox.addEventListener('dragover', () => uploadBox.classList.add('dragover'));
uploadBox.addEventListener('dragleave', () => uploadBox.classList.remove('dragover'));
uploadBox.addEventListener('drop', (e) => handleFile(e.dataTransfer.files[0]));

async function handleFile(file) {
  if (!file) return;
  uploadedFile = file;

  try {
    let url;
    switch(selectedHost) {
      case 'catbox':
        url = await uploadCatbox(file);
        break;
      case 'pixeldrain':
        const customName = prompt('Nama file (opsional):') || file.name;
        url = await uploadPixeldrain(file, customName);
        break;
      case 'transfer':
        const transferName = prompt('Nama file (opsional):') || file.name;
        url = await uploadTransfer(file, transferName);
        break;
      case '0x0':
        url = await upload0x0(file);
        break;
      case 'fileio':
        url = await uploadFileio(file);
        break;
      case 'gofile':
        url = await uploadGofile(file);
        break;
      case 'oshi':
        const oshiName = prompt('Nama file (opsional):') || file.name;
        url = await uploadOshi(file, oshiName);
        break;
      case 'tmpfiles':
        url = await uploadTmpfiles(file);
        break;
    }
    showResult(url);
  } catch (error) {
    alert('Error: ' + error.message);
  }
}

// Upload functions (FIXED)
async function uploadCatbox(file) {
  const form = new FormData();
  form.append('reqtype', 'fileupload');
  form.append('userhash', '');
  form.append('fileToUpload', file);
  
  const response = await fetch('https://catbox.moe/user/api.php', {
    method: 'POST',
    body: form
  });
  
  if (!response.ok) throw new Error('Catbox upload failed');
  return await response.text();
}

async function uploadPixeldrain(file, filename) {
  const form = new FormData();
  form.append('file', file, filename);
  
  const response = await fetch('https://pixeldrain.com/api/file', {
    method: 'POST',
    body: form
  });
  
  const data = await response.json();
  if (!data.id) throw new Error('Pixeldrain upload failed');
  return `https://pixeldrain.com/u/${data.id}`;
}

async function uploadTransfer(file, filename) {
  const response = await fetch(`https://transfer.sh/${encodeURIComponent(filename)}`, {
    method: 'PUT',
    body: file
  });
  
  if (!response.ok) throw new Error('Transfer.sh upload failed');
  return await response.text();
}

async function upload0x0(file) {
  const form = new FormData();
  form.append('file', file);
  
  const response = await fetch('https://0x0.st', {
    method: 'POST',
    body: form
  });
  
  if (!response.ok) throw new Error('0x0.st upload failed');
  return await response.text();
}

async function uploadFileio(file) {
  const response = await fetch('https://file.io/?expires=1w', {
    method: 'POST',
    body: file
  });
  
  const data = await response.json();
  if (!data.link) throw new Error('File.io upload failed');
  return data.link;
}

async function uploadGofile(file) {
  const serverRes = await fetch('https://api.gofile.io/getServer');
  const { data: { server } } = await serverRes.json();
  
  const form = new FormData();
  form.append('file', file);
  
  const response = await fetch(`https://${server}.gofile.io/uploadFile`, {
    method: 'POST',
    body: form
  });
  
  const data = await response.json();
  if (!data.data?.downloadPage) throw new Error('GoFile upload failed');
  return data.data.downloadPage;
}

async function uploadOshi(file, filename) {
  const form = new FormData();
  form.append('file', file, filename);
  
  const response = await fetch('https://oshi.at', {
    method: 'POST',
    body: form
  });
  
  const text = await response.text();
  const match = text.match(/https?:\/\/[^\s]+/);
  if (!match) throw new Error('Oshi.at upload failed');
  return match[0];
}

async function uploadTmpfiles(file) {
  const form = new FormData();
  form.append('file', file);
  
  const response = await fetch('https://tmpfiles.org/api/v1/upload', {
    method: 'POST',
    body: form
  });
  
  const data = await response.json();
  if (!data.data?.url) throw new Error('TmpFiles upload failed');
  return data.data.url;
}

function showResult(url) {
  document.getElementById('resultUrl').href = url;
  document.getElementById('resultUrl').textContent = url;
  
  const preview = document.getElementById('resultPreview');
  preview.innerHTML = '';
  
  if (uploadedFile.type.startsWith('image/')) {
    preview.innerHTML = `<img class="preview-img" src="${url}" alt="Preview">`;
  }
  
  document.getElementById('resultBox').classList.remove('hidden');
}

function copyToClipboard() {
  const url = document.getElementById('resultUrl').textContent;
  navigator.clipboard.writeText(url).then(() => {
    alert('URL copied to clipboard!');
  });
}

renderHosts();
</script>
</body>
</html>
